var manArtMove = [
//   |                                                        |
    "|  O                                                     |\n" +
    "| /|\\                                                    |\n" +
    "| / \\                                                    |\n" +
    "``````````````````````````````````````````````````````````",
    "|   O                                                    |\n" +
    "|  /|\\                                                   |\n" +
    "|  / \\                                                   |\n" +
    "``````````````````````````````````````````````````````````",
    "|    O                                                   |\n" +
    "|   /|\\                                                  |\n" +
    "|   / \\                                                  |\n" +
    "``````````````````````````````````````````````````````````",
    "|     O                                                  |\n" +
    "|    /|\\                                                 |\n" +
    "|    / \\                                                 |\n" +
    "``````````````````````````````````````````````````````````",
    "|      O                                                 |\n" +
    "|     /|\\                                                |\n" +
    "|     / \\                                                |\n" +
    "``````````````````````````````````````````````````````````",
    "|       O                                                |\n" +
    "|      /|\\                                               |\n" +
    "|      / \\                                               |\n" +
    "``````````````````````````````````````````````````````````",
    "|        O                                               |\n" +
    "|       /|\\                                              |\n" +
    "|       / \\                                              |\n" +
    "``````````````````````````````````````````````````````````",
    "|         O                                              |\n" +
    "|        /|\\                                             |\n" +
    "|        / \\                                             |\n" +
    "``````````````````````````````````````````````````````````",
    "|          O                                             |\n" +
    "|         /|\\                                            |\n" +
    "|         / \\                                            |\n" +
    "``````````````````````````````````````````````````````````",
    "|           O                                            |\n" +
    "|          /|\\                                           |\n" +
    "|          / \\                                           |\n" +
    "``````````````````````````````````````````````````````````",
    "|            O                                           |\n" +
    "|           /|\\                                          |\n" +
    "|           / \\                                          |\n" +
    "``````````````````````````````````````````````````````````",
    "|             O                                          |\n" +
    "|            /|\\                                         |\n" +
    "|            / \\                                         |\n" +
    "``````````````````````````````````````````````````````````",
    "|              O                                         |\n" +
    "|             /|\\                                        |\n" +
    "|             / \\                                        |\n" +
    "``````````````````````````````````````````````````````````",
    "|               O                                        |\n" +
    "|              /|\\                                       |\n" +
    "|              / \\                                       |\n" +
    "``````````````````````````````````````````````````````````",
    "|                O                                       |\n" +
    "|               /|\\                                      |\n" +
    "|               / \\                                      |\n" +
    "``````````````````````````````````````````````````````````",
    "|                 O                                      |\n" +
    "|                /|\\                                     |\n" +
    "|                / \\                                     |\n" +
    "``````````````````````````````````````````````````````````",
    "|                  O                                     |\n" +
    "|                 /|\\                                    |\n" +
    "|                 / \\                                    |\n" +
    "``````````````````````````````````````````````````````````",
    "|                   O                                    |\n" +
    "|                  /|\\                                   |\n" +
    "|                  / \\                                   |\n" +
    "``````````````````````````````````````````````````````````",
    "|                    O                                   |\n" +
    "|                   /|\\                                  |\n" +
    "|                   / \\                                  |\n" +
    "``````````````````````````````````````````````````````````",
    "|                     O                                  |\n" +
    "|                    /|\\                                 |\n" +
    "|                    / \\                                 |\n" +
    "``````````````````````````````````````````````````````````",
    "|                      O                                 |\n" +
    "|                     /|\\                                |\n" +
    "|                     / \\                                |\n" +
    "``````````````````````````````````````````````````````````",
    "|                       O                                |\n" +
    "|                      /|\\                               |\n" +
    "|                      / \\                               |\n" +
    "``````````````````````````````````````````````````````````",
    "|                        O                               |\n" +
    "|                       /|\\                              |\n" +
    "|                       / \\                              |\n" +
    "``````````````````````````````````````````````````````````",
    "|                         O                              |\n" +
    "|                        /|\\                             |\n" +
    "|                        / \\                             |\n" +
    "``````````````````````````````````````````````````````````",
    "|                          O                             |\n" +
    "|                         /|\\                            |\n" +
    "|                         / \\                            |\n" +
    "``````````````````````````````````````````````````````````",
    "|                           O                            |\n" +
    "|                          /|\\                           |\n" +
    "|                          / \\                           |\n" +
    "``````````````````````````````````````````````````````````",
    "|                            O                           |\n" +
    "|                           /|\\                          |\n" +
    "|                           / \\                          |\n" +
    "``````````````````````````````````````````````````````````",
    "|                             O                          |\n" +
    "|                            /|\\                         |\n" +
    "|                            / \\                         |\n" +
    "``````````````````````````````````````````````````````````",
    "|                              O                         |\n" +
    "|                             /|\\                        |\n" +
    "|                             / \\                        |\n" +
    "``````````````````````````````````````````````````````````",
    "|                               O                        |\n" +
    "|                              /|\\                       |\n" +
    "|                              / \\                       |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                O                       |\n" +
    "|                               /|\\                      |\n" +
    "|                               / \\                      |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                 O                      |\n" +
    "|                                /|\\                     |\n" +
    "|                                / \\                     |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                  O                     |\n" +
    "|                                 /|\\                    |\n" +
    "|                                 / \\                    |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                   O                    |\n" +
    "|                                  /|\\                   |\n" +
    "|                                  / \\                   |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                    O                   |\n" +
    "|                                   /|\\                  |\n" +
    "|                                   / \\                  |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                     O                  |\n" +
    "|                                    /|\\                 |\n" +
    "|                                    / \\                 |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                      O                 |\n" +
    "|                                     /|\\                |\n" +
    "|                                     / \\                |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                       O                |\n" +
    "|                                      /|\\               |\n" +
    "|                                      / \\               |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                        O               |\n" +
    "|                                       /|\\              |\n" +
    "|                                       / \\              |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                         O              |\n" +
    "|                                        /|\\             |\n" +
    "|                                        / \\             |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                          O             |\n" +
    "|                                         /|\\            |\n" +
    "|                                         / \\            |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                           O            |\n" +
    "|                                          /|\\           |\n" +
    "|                                          / \\           |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                            O           |\n" +
    "|                                           /|\\          |\n" +
    "|                                           / \\          |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                             O          |\n" +
    "|                                            /|\\         |\n" +
    "|                                            / \\         |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                              O         |\n" +
    "|                                             /|\\        |\n" +
    "|                                             / \\        |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                               O        |\n" +
    "|                                              /|\\       |\n" +
    "|                                              / \\       |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                                O       |\n" +
    "|                                               /|\\      |\n" +
    "|                                               / \\      |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                                 O      |\n" +
    "|                                                /|\\     |\n" +
    "|                                                / \\     |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                                  O     |\n" +
    "|                                                 /|\\    |\n" +
    "|                                                 / \\    |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                                   O    |\n" +
    "|                                                  /|\\   |\n" +
    "|                                                  / \\   |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                                    O   |\n" +
    "|                                                   /|\\  |\n" +
    "|                                                   / \\  |\n" +
    "``````````````````````````````````````````````````````````",
    "|                                                     O  |\n" +
    "|                                                    /|\\ |\n" +
    "|                                                    / \\ |\n" +
    "``````````````````````````````````````````````````````````"];
var remyArray = [ //(o.o)
//   |                                                        |
    ".",
    "..",
    "...",
    "..",
    ".",
    " ",
    "o",
    "o.",
    "o.o",
    "o.o)",
    "(o.o)",
    "(o.o) -hello!",
    ];
var remyArrayNum = 0;
var groundCandy = 1;
var collectedCandy = 0;
var waitTime = 500;
var maxBag = 50;
var bag = ["hand", "margarita glass", "pocket", "paper bag", "ripped shirt", "moist bucket", "backpack",
           "trash bag", "squeaky wagon","rusty shopping cart", "minivan", "moldy RV", "delivery truck",
           "semi-truck", "cargo plane", "freight train", "cargo ship", "alien ufo", "bottomless bag"];
var bagLvl = 0;
var locked = false;
var manArtNum = 0; // MAX 51
var goRight = true;
var greyRotate = true;
var blueRotate = true;
var tomatoRotate = true;
var commonFinds = ["stick", "penny", "solo cup", "shoelace", "bobby pin", "hair tie", "flip flop", "pebble", "cigarette butt",
                   "leaf", "water bottle", "gel pen", "bubble gum", "used chapstick", "broken glass", "fishing hook", "light bulb",
                   "sock", "cola can", "lollipop stick", "blue plastic bag", "metal bolt", "Lego brick", "plastic fan blade",
                   "moist cotton ball", "candy mint", "plastic spork", "brick", "ripped napkin", "hubcap", "golf ball",
                   "phillips screwdriver", "flathead screwdriver", "bouncy ball", "seashell", "hand sanitizer", "toilet paper",
                   "TV remote", "AA battery", "dog whistle", "note card", "soda cap", "stick of butter", "dead brown cricket",
                   "red maple leaf", "plastic straw", "cold chicken nugget", "french fry", "broom", "used earbuds", "brown teddy bear",
                   "metal pot", "candlestick", "metal chair", "broken alarm clock", "flower pot", "lampshade", "coffee mug",
                   "broken picture frame", "ceramic plate", "red balloon", "melted ice cream cone", "set of dice", "mittens", "gloves",
                   "binder clip", "pencil sharpener", "ruler", "tac", "guitar pic", "rope", "empty mason jar", "water balloon",
                   "bird feeder", "pineapple", "watermelon", "ball of yarn", "baby bottle", "juice box", "frisbee", "hockey puck",
                   "puzzle piece", "cracked cd", "band-aid", "crayon", "hairball", "construction cone", "salt and pepper shakers",
                   "toothpaste", "toothbrush"];
var rareFinds = ["marble", "top hat", "sea shell", "Rubik's cube", "metal scooter", "street stop sign", "flat car tire",
                 "broken mailbox", "golf hat", "golf club", "MLB baseball", "NBA basketball", "NFL football",
                 "long-spined sea urchin", "unlocked combo lock", "$100 bill", "calculator", "swiss army knife", "flashlight",
                 "flint and steel", "skateboard", "ship in a bottle", "wireless headphones", "bottle of champagne", "small purse",
                 "toaster oven", "electric guitar", "oil lantern", "rainbow scarf", "globe", "American flag", "binoculars", "nunchucks",
                 "bowling ball", "record player", "stick of dynamite", "Chinese lantern", "saw blade", "blowtorch", "knit scarf"];
var mythicalFinds = ["iPhone", "Gandalf's wizard staff", "four-leaf clover","glock 43", "rusty revolver", "engagement ring",
                     "Porsche car keys", "DSLR camera", "Excalibur sword", "gold plated pocket watch", "constitution of the united states",
                     "t-rex fossil", "pink hoverboard", "Thor's hammer", "Luke's lightsaber", "Jumanji game board", "Captain Americas shield",
                     "golden chopsticks", "Poseidon's trident", "Flacon Heavy rocket booster"];
let findDuplicates = arr => arr.filter((item, index) => arr.indexOf(item) != index);
console.log("common duplicates = " + findDuplicates(commonFinds));
console.log("common find length = " + commonFinds.length);
console.log("rare duplicates = " + findDuplicates(rareFinds));
console.log("rare find length = " + rareFinds.length);
console.log("mythical duplicates = " + findDuplicates(mythicalFinds));
console.log("mythical find length = " + mythicalFinds.length);
var commonProgInt = 1;
var commonRandArray = getRandomArray(0,89); // adjust to common finds (0, x)... remember -1 for x
var CRA = 0;
var rareProgInt = 1;
var rareRandArray = getRandomArray(0,39); // adjust to rare finds (0, x)... remember -1 for x
var RRA = 0;
var mythicalProgInt = 1;
var mythicalRandArray = getRandomArray(0,19); // adjust to mythical finds (0, x)... remember -1 for x
var MRA = 0;
var eatenCandies = 0;
var overflowing = false;
//Hide items on start
document.getElementById("bagPercent").style.display = "none";
document.getElementById("upgradeBagButton").style.display = "none";
document.getElementById("findsBox").style.display = "none";
document.getElementById("rareList").style.display = "none";
document.getElementById("mythicalList").style.display = "none";
document.getElementById("remyBox").style.display = "none";

function start() { // Run on start
    setInterval(function() {
        groundCandy++;       
        if (groundCandy <= 1) {
        document.getElementById("ground").innerHTML = "there is " + groundCandy + " candy on the ground.";
        } else {
        document.getElementById("ground").innerHTML = "there are " + groundCandy + " candies on the ground.";
        }
    }, waitTime);
}

function collectCandy() { // when grab candies button is pushed
    if (!locked) { // spam protection
        locked = true;
        setTimeout(unlock, waitTime);
        collectedCandy = collectedCandy + groundCandy;
        if (collectedCandy >= 10) {
            document.getElementById("remyBox").style.display = "block";
        }
        if (collectedCandy > maxBag) { // overflow protection
            //groundyCandy = maxBag - collectCandy; // switched for a second to make checkForFinds() work
            groundCandy = collectedCandy - maxBag;
            collectedCandy = maxBag;
            document.getElementById("grabCandy").disabled = true;
            document.getElementById("grabCandy").style.cursor = "not-allowed";
            if (overflowing == false) {
                checkForFinds();
                overflowing = true;
            }
        } else {
            checkForFinds();            
            groundCandy = 0;
            document.getElementById("grabCandy").disabled = false;
            document.getElementById("grabCandy").style.cursor = "default";
            overflowing = false;
        }
        
        document.getElementById("grabCandy").disabled = true;
        document.getElementById("grabCandy").style.cursor = "not-allowed";
        
        showCandyBag();
        showPercent();
        testForUpgradeAndShow();
        moveMan();

    }
}

function unlock () { // part of collectCandy()...spam proctection for grab candies btn
    locked = false;
    document.getElementById("grabCandy").disabled = false;
    document.getElementById("grabCandy").style.cursor = "default";
}

function showPercent() { // show %full
    var percentFull = collectedCandy * 100 / maxBag;
    if (percentFull <= 75) { // Color selector for %full
        document.getElementById("percentage").style.color = "green";
    } else if (percentFull > 75 && percentFull < 95) {
        document.getElementById("percentage").style.color = "orange";
    } else {
        document.getElementById("percentage").style.color = "red";
    }
    
    document.getElementById("bagPercent").style.display = "block";    
    document.getElementById("percentage").innerHTML = Math.round(percentFull) + "% ";
    document.getElementById("defBag").innerHTML = bag[bagLvl];
}

function showCandyBag() { // shows "you have x candies in your hand."
    if (collectedCandy == 1) {
        document.getElementById("collected").innerHTML = "you have " + collectedCandy + " candy in your " + bag[bagLvl] + ".";
    } else {
        document.getElementById("collected").innerHTML = "you have " + collectedCandy + " candies in your " + bag[bagLvl] + ".";
    }
}

function testForUpgradeAndShow() { // hide button if you cant upgrade.
    if (collectedCandy == maxBag) {
        document.getElementById("upgradeBagButton").style.display = "block";
    } else {
        document.getElementById("upgradeBagButton").style.display = "none";
    }

}

function upgradeBag() { // upgrade button
    bagLvl ++;
    waitTime = waitTime - 30;
    collectedCandy = 0;
    showCandyBag();
    showPercent();
    maxBag = maxBag * 2;
    document.getElementById("upgradeBagButton").style.display = "none";
    document.getElementById("grabCandy").disabled = false;
    document.getElementById("grabCandy").style.cursor = "default";
}

function moveMan() { // moves man left an right when candies collected

    document.getElementById("manSetting").innerHTML = manArtMove[manArtNum];
    if (goRight == true && manArtNum < 51) {
        manArtNum++;
    } else if (manArtNum == 51) {
        goRight = false;
        manArtNum--;
    } else if (goRight == false && manArtNum > 0){
        manArtNum--;
    } else {
        goRight = true;
        manArtNum++;
    }
    
}

function showCommon() { // for when common btn is pushed
    document.getElementById("commonList").style.display = "block";
    document.getElementById("rareList").style.display = "none";
    document.getElementById("mythicalList").style.display = "none";
}

function showRare() { // for when rare btn is pushed
    document.getElementById("commonList").style.display = "none";
    document.getElementById("rareList").style.display = "block";
    document.getElementById("mythicalList").style.display = "none";
}

function showMythical() { // for when mythical btn is pushed
    document.getElementById("commonList").style.display = "none";
    document.getElementById("rareList").style.display = "none";
    document.getElementById("mythicalList").style.display = "block";
}

function commonListAdd() { // adds found item to common list
    document.getElementById("findsBox").style.display = "block"; // display finds box
    var node = document.createElement("LI"); 
    if (greyRotate == true) {   // switch between grey and white
        node.setAttribute("id", "lightgrey");
        greyRotate = false;
    } else {
        greyRotate = true;
    }
    var textnode = document.createTextNode(commonFinds[commonRandArray[CRA]]);
    CRA++;
    node.appendChild(textnode);
    document.getElementById("commonListUl").appendChild(node);
    document.getElementById("commonProgress").innerHTML = commonProgInt + "/90";
    commonProgInt ++;
    document.getElementById("displayFind").innerHTML = "COMMON ITEM FOUND";     //display find
    document.getElementById("displayFind").style.background = "lightgrey";
    $("#displayFind").finish().show().delay(2000).fadeOut(3000);

    setTimeout(function() {
    $("#displayFind").finish().show();
    document.getElementById("displayFind").style.background = "white";
    document.getElementById("displayFind").innerHTML = "&nbsp;";
    }, 5000);   
}

function rareListAdd() { // adds found item to rare list
    document.getElementById("findsBox").style.display = "block"; // display finds box
    var node = document.createElement("LI"); 
    if (blueRotate == true) {   // switch blue and white
        node.setAttribute("id", "cadetblue");
        blueRotate = false;
    } else {
        blueRotate = true;
    }
    var textnode = document.createTextNode(rareFinds[rareRandArray[RRA]]);
    RRA++;
    node.appendChild(textnode);
    document.getElementById("rareListUl").appendChild(node);
    document.getElementById("rareProgress").innerHTML = rareProgInt + "/90";
    rareProgInt ++;
    document.getElementById("displayFind").innerHTML = "RARE ITEM FOUND";     //display find
    document.getElementById("displayFind").style.background = "cadetblue";
    $("#displayFind").finish().show().delay(2000).fadeOut(3000);

    setTimeout(function() {
    $("#displayFind").finish().show();
    document.getElementById("displayFind").style.background = "white";
    document.getElementById("displayFind").innerHTML = "&nbsp;";
    }, 5000);   
}

function mythicalListAdd() { // adds found item to mythical list
    document.getElementById("findsBox").style.display = "block"; // display finds box
    var node = document.createElement("LI"); 
    if (tomatoRotate == true) {   // switch blue and white
        node.setAttribute("id", "tomato");
        tomatoRotate = false;
    } else {
        tomatoRotate = true;
    }
    var textnode = document.createTextNode(mythicalFinds[mythicalRandArray[MRA]]);
    MRA++;
    node.appendChild(textnode);
    document.getElementById("mythicalListUl").appendChild(node);
    document.getElementById("mythicalProgress").innerHTML = mythicalProgInt + "/20";
    mythicalProgInt ++;
    document.getElementById("displayFind").innerHTML = "MYTHICAL ITEM FOUND";     //display find
    document.getElementById("displayFind").style.background = "tomato";
    $("#displayFind").finish().show().delay(2000).fadeOut(3000);

    setTimeout(function() {
    $("#displayFind").finish().show();
    document.getElementById("displayFind").style.background = "white";
    document.getElementById("displayFind").innerHTML = "&nbsp;";
    }, 5000);   
}

function getRandom(min, max) { //random number generator... getRandom(1, 10) = includes 1 and 10
    return Math.floor(Math.random() * (max - min + 1) ) + min;
}

function getRandomArray(min,max){ // cant remember what this is for but its important... smt to do with finds
    var A= [];
    while(max>= min) A.push(max--);    
    A.sort(function(){return 0.5- Math.random();});  
    return A;
}

function checkForFinds() { //checks to see if the player has found smt

    //console.log("gc = " + groundCandy);
    for (x = 0; x < groundCandy; x++) {
    
        i = getRandom(1,600);
        if (i == 4 || i == 5 || i == 6 && commonProgInt <= 90) { // adjust for number of possible finds 3/600
            commonListAdd();
        }
        if (i == 2 || i == 3 && commonProgInt <= 40) { // adjust for number of possible finds 2/600
            rareListAdd();
        }
        if (i == 1 && commonProgInt <= 20) { // adjust for number of possible finds 1/600
            mythicalListAdd();
        }
        //console.log(x +"random = " + i);
    }
}

function eatCandy() {

    if (collectedCandy >= 10 && eatenCandies < 1000) {
        collectedCandy = collectedCandy - 10;
        eatenCandies = eatenCandies + 10;
        remyProg();
    } else if (collectedCandy >= 25 && eatenCandies >= 1000) {
        collectedCandy = collectedCandy - 25;
        eatenCandies = eatenCandies + 25;
        remyProg();
    }
    
    document.getElementById("eatenCandies").innerHTML = "you have eaten " + eatenCandies + " candies";

    testForUpgradeAndShow();   
    showCandyBag();
    showPercent();

}

function remyProg() {
    document.getElementById("remyProg").innerHTML = remyArray[remyArrayNum];
    remyArrayNum++;
}